#!/usr/bin/env php
<?php
require_once __DIR__.'/vendor/autoload.php';

use Illuminate\Container\Container;
use Illuminate\Events\Dispatcher;
use Illuminate\Console\Application;
use Webman\Config;


if (!in_array( $argv[1] ?? '',['start','restart','stop','status','reload','connections'] )) {
    require_once __DIR__.'/support/bootstrap.php';
} else {
    if (class_exists( 'Support\App' )) {
        Support\App::loadAllConfig( ['route'] );
    } else {
        Config::reload( config_path(),['route','container'] );
    }
}
$container = new Container;
$events    = new Dispatcher( $container );
$artisan   = new Application( $container,$events,'v1.0' );
$artisan->setName( 'webman for laravel cli' );
$artisan->resolveCommands( config( 'command' ) );
$artisan->setCatchExceptions( true );
$artisan->run();

